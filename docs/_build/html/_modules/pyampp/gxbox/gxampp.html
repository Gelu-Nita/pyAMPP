

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pyampp.gxbox.gxampp &mdash; pyAMPP 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
      <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            pyAMPP
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../model_hdf5_format.html">pyAMPP HDF5 Model Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gui_workflow.html">pyAMPP GUI Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../viewers.html">Model Viewers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changelog.html#id1">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyAMPP</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pyampp.gxbox.gxampp</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pyampp.gxbox.gxampp</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">select</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shlex</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QLineEdit</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QComboBox</span><span class="p">,</span>
                             <span class="n">QRadioButton</span><span class="p">,</span>
                             <span class="n">QCheckBox</span><span class="p">,</span> <span class="n">QGridLayout</span><span class="p">,</span> <span class="n">QGroupBox</span><span class="p">,</span> <span class="n">QButtonGroup</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QDateTimeEdit</span><span class="p">,</span>
                             <span class="n">QCalendarWidget</span><span class="p">,</span> <span class="n">QTextEdit</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDockWidget</span><span class="p">,</span> <span class="n">QToolButton</span><span class="p">,</span> <span class="n">QMenu</span><span class="p">,</span>
                             <span class="n">QFileDialog</span><span class="p">,</span> <span class="n">QStyle</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtGui</span><span class="w"> </span><span class="kn">import</span> <span class="n">QIcon</span><span class="p">,</span> <span class="n">QFont</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">QDateTime</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QTimer</span><span class="p">,</span> <span class="n">QSettings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PyQt5</span><span class="w"> </span><span class="kn">import</span> <span class="n">uic</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pyampp.util.config</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pyampp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyampp.gxbox.boxutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_b3d_h5</span><span class="p">,</span> <span class="n">validate_number</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyampp.gxbox.gx_fov2box</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">_load_entry_box_any</span><span class="p">,</span>
    <span class="n">_entry_stage_from_loaded</span><span class="p">,</span>
    <span class="n">_extract_execute_paths</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyampp.util.idl_execute_to_gxfov2box</span><span class="w"> </span><span class="kn">import</span> <span class="n">_parse_idl_call</span><span class="p">,</span> <span class="n">_build_gx_fov2box_command</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.time</span><span class="w"> </span><span class="kn">import</span> <span class="n">Time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sunpy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_earth</span><span class="p">,</span> <span class="n">HeliographicStonyhurst</span><span class="p">,</span> <span class="n">HeliographicCarrington</span><span class="p">,</span> <span class="n">Helioprojective</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sunpy.sun</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">sun_consts</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">typer</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

<div class="viewcode-block" id="app">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.app">[docs]</a>
<span class="n">app</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Typer</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s2">&quot;Launch the PyAmpp application.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="base_dir">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.base_dir">[docs]</a>
<span class="n">base_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">pyampp</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span></div>



<div class="viewcode-block" id="CustomQLineEdit">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.CustomQLineEdit">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CustomQLineEdit</span><span class="p">(</span><span class="n">QLineEdit</span><span class="p">):</span>
<div class="viewcode-block" id="CustomQLineEdit.setTextL">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.CustomQLineEdit.setTextL">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setTextL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the text of the QLineEdit and moves the cursor to the beginning.</span>

<span class="sd">        :param text: str</span>
<span class="sd">            The text to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCursorPosition</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="PyAmppGUI">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PyAmppGUI</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main application GUI for the Solar Data Model.</span>

<span class="sd">    This class creates the main window and sets up the user interface for managing solar data and model configurations.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    central_widget : QWidget</span>
<span class="sd">        The central widget of the main window.</span>
<span class="sd">    main_layout : QVBoxLayout</span>
<span class="sd">        The main layout for the central widget.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    initUI():</span>
<span class="sd">        Initializes the user interface.</span>
<span class="sd">    add_data_repository_section():</span>
<span class="sd">        Adds the data repository section to the UI.</span>
<span class="sd">    update_sdo_data_dir():</span>
<span class="sd">        Updates the SDO data directory path.</span>
<span class="sd">    update_gxmodel_dir():</span>
<span class="sd">        Updates the GX model directory path.</span>
<span class="sd">    update_external_box_dir():</span>
<span class="sd">        Updates the external box directory path.</span>
<span class="sd">    update_dir(new_path, default_path):</span>
<span class="sd">        Updates the specified directory path.</span>
<span class="sd">    open_sdo_file_dialog():</span>
<span class="sd">        Opens a file dialog for selecting the SDO data directory.</span>
<span class="sd">    open_gx_file_dialog():</span>
<span class="sd">        Opens a file dialog for selecting the GX model directory.</span>
<span class="sd">    open_external_file_dialog():</span>
<span class="sd">        Opens a file dialog for selecting the external box directory.</span>
<span class="sd">    add_model_configuration_section():</span>
<span class="sd">        Adds the model configuration section to the UI.</span>
<span class="sd">    add_options_section():</span>
<span class="sd">        Adds the options section to the UI.</span>
<span class="sd">    add_cmd_display():</span>
<span class="sd">        Adds the command display section to the UI.</span>
<span class="sd">    add_cmd_buttons():</span>
<span class="sd">        Adds command buttons to the UI.</span>
<span class="sd">    add_status_log():</span>
<span class="sd">        Adds the status log section to the UI.</span>
<span class="sd">    update_command_display():</span>
<span class="sd">        Updates the command display with the current command.</span>
<span class="sd">    update_hpc_state(checked):</span>
<span class="sd">        Updates the UI when Helioprojective coordinates are selected.</span>
<span class="sd">    update_hgc_state(checked):</span>
<span class="sd">        Updates the UI when Heliographic Carrington coordinates are selected.</span>
<span class="sd">    get_command():</span>
<span class="sd">        Constructs the command based on the current UI settings.</span>
<span class="sd">    execute_command():</span>
<span class="sd">        Executes the constructed command.</span>
<span class="sd">    save_command():</span>
<span class="sd">        Saves the current command.</span>
<span class="sd">    refresh_command():</span>
<span class="sd">        Refreshes the current session.</span>
<span class="sd">    clear_command():</span>
<span class="sd">        Clears the status log.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the PyAmppGUI class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<div class="viewcode-block" id="PyAmppGUI.info_only_box">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.info_only_box">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_only_box</span> <span class="o">=</span> <span class="kc">None</span></div>

        <span class="bp">self</span><span class="o">.</span><span class="n">_last_model_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_valid_entry_box</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entry_stage_detected</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entry_type_detected</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hydrating_entry</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proc_timer</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proc_timer</span><span class="o">.</span><span class="n">setInterval</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_proc_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_gxbox_process</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span> <span class="o">=</span> <span class="n">QSettings</span><span class="p">(</span><span class="s2">&quot;SUNCAST&quot;</span><span class="p">,</span> <span class="s2">&quot;pyAMPP&quot;</span><span class="p">)</span>
<div class="viewcode-block" id="PyAmppGUI.model_time_orig">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.model_time_orig">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_time_orig</span> <span class="o">=</span> <span class="kc">None</span></div>

        <span class="c1"># self.rotate_to_time_button = None</span>
<div class="viewcode-block" id="PyAmppGUI.rotate_revert_button">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.rotate_revert_button">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyAmppGUI.coords_center">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.coords_center">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="PyAmppGUI.coords_center_orig">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.coords_center_orig">[docs]</a>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords_center_orig</span> <span class="o">=</span> <span class="kc">None</span></div>

        <span class="bp">self</span><span class="o">.</span><span class="n">initUI</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_has_entry_box</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_stage_to_jump_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stage</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">stage</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;NONE&quot;</span><span class="p">:</span> <span class="s2">&quot;none&quot;</span><span class="p">,</span>
            <span class="s2">&quot;POT&quot;</span><span class="p">:</span> <span class="s2">&quot;potential&quot;</span><span class="p">,</span>
            <span class="s2">&quot;BND&quot;</span><span class="p">:</span> <span class="s2">&quot;bounds&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NAS&quot;</span><span class="p">:</span> <span class="s2">&quot;nlfff&quot;</span><span class="p">,</span>
            <span class="s2">&quot;GEN&quot;</span><span class="p">:</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="s2">&quot;CHR&quot;</span><span class="p">:</span> <span class="s2">&quot;chromo&quot;</span><span class="p">,</span>
        <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s2">&quot;none&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_model_params_enabled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">widgets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proj_cea_radio</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proj_top_radio</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid_x_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid_y_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid_z_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">res_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">padding_size_edit</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disambig_hmi_radio</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disambig_sfq_radio</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">widgets</span><span class="p">:</span>
            <span class="n">w</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>

<div class="viewcode-block" id="PyAmppGUI.initUI">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.initUI">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">initUI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets up the initial user interface for the main window.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Main widget and layout</span>
        <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;UI&quot;</span> <span class="o">/</span> <span class="s2">&quot;gxampp.ui&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;GX Automatic Production Pipeline Interface&quot;</span><span class="p">)</span>

        <span class="c1"># Adding different sections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_data_repository_section</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_model_configuration_section</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_options_section</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_cmd_display</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_cmd_buttons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_status_log</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_coords_center</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.add_data_repository_section">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.add_data_repository_section">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_data_repository_section</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_repository_section</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">setColumnStretch</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;paths/data_dir&quot;</span><span class="p">,</span> <span class="n">DOWNLOAD_DIR</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">520</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_sdo_data_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_persist_data_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_browse_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_sdo_file_dialog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_browse_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_browse_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SP_DirOpenIcon</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_browse_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Select SDO data repository&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_browse_button</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;paths/gxmodel_dir&quot;</span><span class="p">,</span> <span class="n">GXMODEL_DIR</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">520</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_gxmodel_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_persist_gxmodel_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_browse_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_gx_file_dialog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_browse_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_browse_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SP_DirOpenIcon</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_browse_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Select GX model repository&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_browse_button</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>

        <span class="n">notify_email</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PYAMPP_JSOC_NOTIFY_EMAIL&quot;</span><span class="p">,</span> <span class="n">JSOC_NOTIFY_EMAIL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsoc_notify_email_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">notify_email</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jsoc_notify_email_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_jsoc_notify_email</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">520</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_external_box_dir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_browse_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">open_external_file_dialog</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_browse_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_browse_button</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">()</span><span class="o">.</span><span class="n">standardIcon</span><span class="p">(</span><span class="n">QStyle</span><span class="o">.</span><span class="n">SP_DirOpenIcon</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_browse_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Select entry model file (.h5/.sav)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_browse_button</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Detected Entry Type:&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_edit</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_edit</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_edit</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="mi">130</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_edit</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Detected entry type, e.g. POT.GEN.SAV or NAS.CHR.H5&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continue_radio</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Continue&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Rebuild from NONE&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;Rebuild from OBS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continue_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continue_radio</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_mode_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">mode_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_mode_widget</span><span class="p">)</span>
        <span class="n">mode_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">mode_layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">mode_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_edit</span><span class="p">)</span>
        <span class="n">mode_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">continue_radio</span><span class="p">)</span>
        <span class="n">mode_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span><span class="p">)</span>
        <span class="n">mode_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span><span class="p">)</span>
        <span class="n">mode_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_label</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entry_mode_widget</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.update_sdo_data_dir">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_sdo_data_dir">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_sdo_data_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the SDO data directory path based on the user input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_dir</span><span class="p">(</span><span class="n">new_path</span><span class="p">,</span> <span class="n">DOWNLOAD_DIR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_persist_data_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.update_gxmodel_dir">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_gxmodel_dir">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_gxmodel_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the GX model directory path based on the user input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_dir</span><span class="p">(</span><span class="n">new_path</span><span class="p">,</span> <span class="n">GXMODEL_DIR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_persist_gxmodel_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_persist_data_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;paths/data_dir&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">text</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_persist_gxmodel_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_settings</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;paths/gxmodel_dir&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">text</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<div class="viewcode-block" id="PyAmppGUI.update_jsoc_notify_email">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_jsoc_notify_email">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_jsoc_notify_email</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the JSOC notify email via the PYAMPP_JSOC_NOTIFY_EMAIL environment variable.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_email</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jsoc_notify_email_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">new_email</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYAMPP_JSOC_NOTIFY_EMAIL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_email</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;PYAMPP_JSOC_NOTIFY_EMAIL&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">jsoc_notify_email_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">JSOC_NOTIFY_EMAIL</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.read_external_box">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.read_external_box">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">read_external_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads the external box path based on the user input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">boxfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hydrating_entry</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">boxdata</span> <span class="o">=</span> <span class="n">_load_entry_box_any</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">boxfile</span><span class="p">))</span>
            <span class="n">entry_stage</span> <span class="o">=</span> <span class="n">_entry_stage_from_loaded</span><span class="p">(</span><span class="n">boxdata</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">boxfile</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_stage_detected</span> <span class="o">=</span> <span class="n">entry_stage</span>
            <span class="n">entry_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_derive_entry_type</span><span class="p">(</span><span class="n">boxdata</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">boxfile</span><span class="p">),</span> <span class="n">entry_stage</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_type_detected</span> <span class="o">=</span> <span class="n">entry_type</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">entry_type</span><span class="p">)</span>

            <span class="n">execute_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_meta_value</span><span class="p">(</span><span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;execute&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_execute_defaults</span><span class="p">(</span><span class="n">execute_text</span><span class="p">,</span> <span class="n">boxdata</span><span class="p">)</span>
            <span class="c1"># Canonical time comes from entry model identity (id/path), not stale execute text.</span>
            <span class="c1"># This guarantees &quot;Rebuild from OBS&quot; uses the uploaded model timestamp.</span>
            <span class="n">entry_dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_entry_datetime</span><span class="p">(</span><span class="n">boxdata</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="n">boxfile</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">entry_dt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">setDateTime</span><span class="p">(</span><span class="n">QDateTime</span><span class="p">(</span><span class="n">entry_dt</span><span class="p">))</span>
            <span class="n">exec_data_dir</span><span class="p">,</span> <span class="n">exec_model_dir</span> <span class="o">=</span> <span class="n">_extract_execute_paths</span><span class="p">(</span><span class="n">execute_text</span><span class="p">)</span>
            <span class="n">warnings</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">exec_data_dir</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">exec_data_dir</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">DOWNLOAD_DIR</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid execute data-dir on this system, using default: </span><span class="si">{</span><span class="n">DOWNLOAD_DIR</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">exec_model_dir</span><span class="p">:</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">exec_model_dir</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">GXMODEL_DIR</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid execute gxmodel-dir on this system, using default: </span><span class="si">{</span><span class="n">GXMODEL_DIR</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_persist_data_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_persist_gxmodel_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

            <span class="c1"># Keep command state predictable when importing an entry box.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_pipeline_checks_for_entry</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_jump_action</span><span class="p">(</span><span class="s2">&quot;continue&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_valid_entry_box</span> <span class="o">=</span> <span class="n">boxfile</span>
            <span class="k">if</span> <span class="n">warnings</span><span class="p">:</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Entry Box Path Warnings&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">warnings</span><span class="p">))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hydrating_entry</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_model_params_enabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_derive_entry_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxdata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">entry_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">entry_stage</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">meta_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_meta_value</span><span class="p">(</span><span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">stage_path</span> <span class="o">=</span> <span class="n">entry_stage</span>
        <span class="k">if</span> <span class="s2">&quot;.CEA.&quot;</span> <span class="ow">in</span> <span class="n">meta_id</span><span class="p">:</span>
            <span class="n">stage_path</span> <span class="o">=</span> <span class="n">meta_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.CEA.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;.TOP.&quot;</span> <span class="ow">in</span> <span class="n">meta_id</span><span class="p">:</span>
            <span class="n">stage_path</span> <span class="o">=</span> <span class="n">meta_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.TOP.&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">stage_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infer_stage_path_from_content</span><span class="p">(</span><span class="n">boxdata</span><span class="p">,</span> <span class="n">stage_path</span><span class="p">)</span>
        <span class="n">suffix</span> <span class="o">=</span> <span class="n">entry_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">file_tag</span> <span class="o">=</span> <span class="s2">&quot;SAV&quot;</span> <span class="k">if</span> <span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.sav&quot;</span> <span class="k">else</span> <span class="s2">&quot;H5&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stage_path</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">file_tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_infer_entry_datetime</span><span class="p">(</span><span class="n">boxdata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">entry_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Infer observation datetime from metadata id or filename token YYYYMMDD_HHMMSS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">meta</span> <span class="o">=</span> <span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boxdata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">meta_id</span> <span class="o">=</span> <span class="n">PyAmppGUI</span><span class="o">.</span><span class="n">_decode_meta_value</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">[</span><span class="n">meta_id</span><span class="p">,</span> <span class="n">entry_path</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span> <span class="n">entry_path</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d</span><span class="si">{8}</span><span class="s2">_\d</span><span class="si">{6}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">text</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_has_lines_metadata</span><span class="p">(</span><span class="n">boxdata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">required</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;codes&quot;</span><span class="p">,</span> <span class="s2">&quot;apex_idx&quot;</span><span class="p">,</span> <span class="s2">&quot;start_idx&quot;</span><span class="p">,</span> <span class="s2">&quot;end_idx&quot;</span><span class="p">,</span> <span class="s2">&quot;seed_idx&quot;</span><span class="p">,</span> <span class="s2">&quot;av_field&quot;</span><span class="p">,</span> <span class="s2">&quot;phys_length&quot;</span><span class="p">,</span> <span class="s2">&quot;voxel_status&quot;</span><span class="p">}</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;lines&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">required</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">lines</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="c1"># Backward compatibility: old files stored line arrays under chromo.</span>
        <span class="n">chromo</span> <span class="o">=</span> <span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chromo&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chromo</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">required</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">chromo</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_infer_stage_path_from_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxdata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">stage_path_hint</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">hint</span> <span class="o">=</span> <span class="p">(</span><span class="n">stage_path_hint</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">corona</span> <span class="o">=</span> <span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;corona&quot;</span><span class="p">,</span> <span class="p">{})</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boxdata</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">model_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">corona</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="n">corona</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;attrs&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attrs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">model_type</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;model_type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">has_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_lines_metadata</span><span class="p">(</span><span class="n">boxdata</span><span class="p">)</span>
        <span class="n">has_chromo</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;chromo&quot;</span><span class="p">),</span> <span class="nb">dict</span><span class="p">)</span>

        <span class="c1"># First derive POT/NAS branch from data, fallback to hint.</span>
        <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;pot&quot;</span> <span class="ow">or</span> <span class="n">hint</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;POT&quot;</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;POT&quot;</span>
        <span class="k">elif</span> <span class="n">model_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;nlfff&quot;</span><span class="p">,</span> <span class="s2">&quot;nas&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">hint</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;NAS&quot;</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;NAS&quot;</span>
        <span class="k">elif</span> <span class="n">hint</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;BND&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">model_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;bnd&quot;</span><span class="p">,</span> <span class="s2">&quot;bounds&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;BND&quot;</span>
        <span class="k">elif</span> <span class="n">hint</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;NONE&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;NONE&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;NAS&quot;</span>

        <span class="c1"># Then derive stage detail from content (not ID text).</span>
        <span class="k">if</span> <span class="n">has_chromo</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.GEN.CHR&quot;</span> <span class="k">if</span> <span class="n">has_lines</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.CHR&quot;</span>
        <span class="k">if</span> <span class="n">has_lines</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.GEN&quot;</span>
        <span class="k">if</span> <span class="n">prefix</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;POT&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;NAS&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_decode_meta_value</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">&quot;item&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">vv</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">vv</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">)):</span>
                    <span class="k">return</span> <span class="n">vv</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">vv</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_execute_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">execute_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">boxdata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Populate GUI fields from entry model metadata/execute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">parsed_cmd</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="n">execute_text</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
            <span class="c1"># Native Python execute string stored in metadata.</span>
            <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;gx-fov2box&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot; --&quot;</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">parsed_cmd</span> <span class="o">=</span> <span class="n">shlex</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="n">parsed_cmd</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># IDL execute string fallback.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">parsed_cmd</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">_parse_idl_call</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
                    <span class="n">parsed</span> <span class="o">=</span> <span class="n">_build_gx_fov2box_command</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
                    <span class="n">parsed_cmd</span> <span class="o">=</span> <span class="n">parsed</span><span class="o">.</span><span class="n">command</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="n">parsed_cmd</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Parse translated command tokens into a simple option map.</span>
        <span class="n">flag_arity</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;--time&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;--coords&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;--box-dims&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;--dx-km&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;--pad-frac&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;--data-dir&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;--gxmodel-dir&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">opts</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed_cmd</span><span class="p">):</span>
            <span class="n">tok</span> <span class="o">=</span> <span class="n">parsed_cmd</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">flag_arity</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">flag_arity</span><span class="p">[</span><span class="n">tok</span><span class="p">]</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="n">parsed_cmd</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span>
                    <span class="n">opts</span><span class="p">[</span><span class="n">tok</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n</span>
                <span class="k">continue</span>
            <span class="n">opts</span><span class="p">[</span><span class="n">tok</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Fallback extraction for robustness if parser misses.</span>
        <span class="k">if</span> <span class="s2">&quot;--time&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;&#39;(\d{1,2}-[A-Za-z]</span><span class="si">{3}</span><span class="s2">-\d{2,4}\s+\d</span><span class="si">{2}</span><span class="s2">:\d</span><span class="si">{2}</span><span class="s2">:\d</span><span class="si">{2}</span><span class="s2">)&#39;&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">kw</span> <span class="o">=</span> <span class="n">_parse_idl_call</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;gx_fov2box, &#39;</span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                    <span class="n">parsed</span> <span class="o">=</span> <span class="n">_build_gx_fov2box_command</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;--time&quot;</span> <span class="ow">in</span> <span class="n">parsed</span><span class="o">.</span><span class="n">command</span><span class="p">:</span>
                        <span class="n">ti</span> <span class="o">=</span> <span class="n">parsed</span><span class="o">.</span><span class="n">command</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s2">&quot;--time&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">ti</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parsed</span><span class="o">.</span><span class="n">command</span><span class="p">):</span>
                            <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">parsed</span><span class="o">.</span><span class="n">command</span><span class="p">[</span><span class="n">ti</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">if</span> <span class="s2">&quot;--coords&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;CENTER_ARCSEC\s*=\s*\[\s*([^\],]+)\s*,\s*([^\]]+)\s*\]&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>
                <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--hpc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="s2">&quot;--box-dims&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;SIZE_PIX\s*=\s*\[\s*([^\],]+)\s*,\s*([^\],]+)\s*,\s*([^\]]+)\s*\]&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--box-dims&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>

        <span class="c1"># Time</span>
        <span class="k">if</span> <span class="s2">&quot;--time&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">iso</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--time&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">iso</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">setDateTime</span><span class="p">(</span><span class="n">QDateTime</span><span class="p">(</span><span class="n">dt</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="c1"># Frame first (without firing conversion handlers that could overwrite imported coords).</span>
        <span class="k">if</span> <span class="s2">&quot;--hgc&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="n">target_frame</span> <span class="o">=</span> <span class="s2">&quot;hgc&quot;</span>
        <span class="k">elif</span> <span class="s2">&quot;--hgs&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="n">target_frame</span> <span class="o">=</span> <span class="s2">&quot;hgs&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># default to HPC if execute didn&#39;t specify.</span>
            <span class="n">target_frame</span> <span class="o">=</span> <span class="s2">&quot;hpc&quot;</span>

        <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="p">):</span>
            <span class="n">rb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">target_frame</span> <span class="o">==</span> <span class="s2">&quot;hpc&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">target_frame</span> <span class="o">==</span> <span class="s2">&quot;hgc&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">target_frame</span> <span class="o">==</span> <span class="s2">&quot;hgs&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="p">):</span>
            <span class="n">rb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Coordinates (apply after frame selection so imported values are not overwritten).</span>
        <span class="k">if</span> <span class="s2">&quot;--coords&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span> <span class="o">=</span> <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--coords&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cx</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cy</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Projection</span>
        <span class="k">if</span> <span class="s2">&quot;--top&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proj_top_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proj_cea_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Box dimensions</span>
        <span class="k">if</span> <span class="s2">&quot;--box-dims&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="o">=</span> <span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--box-dims&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grid_x_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nx</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grid_y_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">grid_z_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nz</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">corona</span> <span class="o">=</span> <span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;corona&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">corona</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;bx&quot;</span> <span class="ow">in</span> <span class="n">corona</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nz</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nx</span> <span class="o">=</span> <span class="n">corona</span><span class="p">[</span><span class="s2">&quot;bx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">grid_x_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nx</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">grid_y_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ny</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">grid_z_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nz</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="c1"># Resolution (dx_km)</span>
        <span class="k">if</span> <span class="s2">&quot;--dx-km&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">res_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">opts</span><span class="p">[</span><span class="s1">&#39;--dx-km&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">corona</span> <span class="o">=</span> <span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;corona&quot;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">corona</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;dr&quot;</span> <span class="ow">in</span> <span class="n">corona</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">dr0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">corona</span><span class="p">[</span><span class="s2">&quot;dr&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">rsun_km</span> <span class="o">=</span> <span class="n">sun_consts</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">res_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dr0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rsun_km</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="c1"># Padding fraction</span>
        <span class="k">if</span> <span class="s2">&quot;--pad-frac&quot;</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pad_frac</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">opts</span><span class="p">[</span><span class="s2">&quot;--pad-frac&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">padding_size_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">pad_frac</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Context map toggles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="s2">&quot;--euv&quot;</span> <span class="ow">in</span> <span class="n">opts</span> <span class="ow">and</span> <span class="s2">&quot;--no-euv&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="s2">&quot;--uv&quot;</span> <span class="ow">in</span> <span class="n">opts</span> <span class="ow">and</span> <span class="s2">&quot;--no-uv&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">)</span>

        <span class="c1"># Disambiguation</span>
        <span class="n">disambig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decode_meta_value</span><span class="p">(</span><span class="n">boxdata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;metadata&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disambiguation&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;--sfq&quot;</span> <span class="ow">in</span> <span class="n">opts</span> <span class="ow">or</span> <span class="n">disambig</span> <span class="o">==</span> <span class="s2">&quot;SFQ&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disambig_sfq_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disambig_hmi_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="PyAmppGUI.update_external_box_dir">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_external_box_dir">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_external_box_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the external box directory path based on the user input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_path</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_stage_detected</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_entry_type_detected</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entry_stage_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_jump_action</span><span class="p">(</span><span class="s2">&quot;continue&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_model_params_enabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">new_path</span><span class="p">):</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Invalid Entry Box&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Path is not a file:</span><span class="se">\n</span><span class="si">{</span><span class="n">new_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_restore_last_valid_entry_box</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_external_box</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Invalid Entry Box&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Could not read entry box:</span><span class="se">\n</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_restore_last_valid_entry_box</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_restore_last_valid_entry_box</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_valid_entry_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span>

<div class="viewcode-block" id="PyAmppGUI.update_dir">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_dir">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_path</span><span class="p">,</span> <span class="n">default_path</span><span class="p">,</span> <span class="n">target_edit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the specified directory path.</span>

<span class="sd">        :param new_path: The new directory path.</span>
<span class="sd">        :type new_path: str</span>
<span class="sd">        :param default_path: The default directory path.</span>
<span class="sd">        :type default_path: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_path</span> <span class="o">!=</span> <span class="n">default_path</span><span class="p">:</span>
            <span class="c1"># Normalize the path whether it&#39;s absolute or relative</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">new_path</span><span class="p">):</span>
                <span class="n">new_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">new_path</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">new_path</span><span class="p">):</span>  <span class="c1"># Checks if the path does not exist</span>
                <span class="c1"># Ask user if they want to create the directory</span>
                <span class="n">reply</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;Create Directory?&#39;</span><span class="p">,</span>
                                             <span class="s2">&quot;The directory does not exist. Do you want to create it?&quot;</span><span class="p">,</span>
                                             <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">reply</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">new_path</span><span class="p">)</span>
                        <span class="c1"># QMessageBox.information(self, &quot;Directory Created&quot;, &quot;The directory was successfully created.&quot;)</span>
                    <span class="k">except</span> <span class="ne">PermissionError</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Permission Denied&quot;</span><span class="p">,</span>
                                             <span class="s2">&quot;You do not have permission to create this directory.&quot;</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to create directory: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># User chose not to create the directory, revert to the original path</span>
                    <span class="k">if</span> <span class="n">target_edit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">target_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">default_path</span><span class="p">)</span></div>

        <span class="c1"># else:</span>
        <span class="c1">#     QMessageBox.warning(self, &quot;Invalid Path&quot;, &quot;The specified path is not a valid absolute path.&quot;)</span>

<div class="viewcode-block" id="PyAmppGUI.open_sdo_file_dialog">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.open_sdo_file_dialog">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">open_sdo_file_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a file dialog for selecting the SDO data directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="n">start_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">DOWNLOAD_DIR</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Select Directory&quot;</span><span class="p">,</span> <span class="n">start_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_sdo_data_dir</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.open_gx_file_dialog">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.open_gx_file_dialog">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">open_gx_file_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a file dialog for selecting the GX model directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="n">start_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">GXMODEL_DIR</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Select Directory&quot;</span><span class="p">,</span> <span class="n">start_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_gxmodel_dir</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.open_external_file_dialog">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.open_external_file_dialog">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">open_external_file_dialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens a file dialog for selecting the external box directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
        <span class="n">options</span> <span class="o">|=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">DontUseNativeDialog</span>
        <span class="n">file_name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Select File&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;Model Files (*.h5 *.sav)&quot;</span><span class="p">)</span>
        <span class="c1"># file_name = QFileDialog.getExistingDirectory(self, &quot;Select Directory&quot;, os.getcwd())</span>
        <span class="k">if</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_external_box_dir</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.add_model_configuration_section">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.add_model_configuration_section">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_model_configuration_section</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Hide legacy jump controls; workflow is linear with optional rebuild.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">jump_to_action_combo</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label_jumpToAction</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">setDateTime</span><span class="p">(</span><span class="n">QDateTime</span><span class="o">.</span><span class="n">currentDateTimeUtc</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">setDateTimeRange</span><span class="p">(</span><span class="n">QDateTime</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">QDateTime</span><span class="p">(</span><span class="n">QDateTime</span><span class="o">.</span><span class="n">currentDateTimeUtc</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTimeChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_time_input_changed</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_coord_x_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_coord_y_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_hpc_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_hgc_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_hgs_state</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">grid_x_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_grid_x_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_x_edit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_y_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_grid_y_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_y_edit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid_z_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_grid_z_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_z_edit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">res_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_res_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_edit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">padding_size_edit</span><span class="o">.</span><span class="n">returnPressed</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_padding_size_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">padding_size_edit</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Heliocentric&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Carrington&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Stonyhurst&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">proj_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Geometrical Projection&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_cea_radio</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;CEA&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_top_radio</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;TOP&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_cea_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_button_group</span> <span class="o">=</span> <span class="n">QButtonGroup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_group</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_button_group</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_cea_radio</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_button_group</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_top_radio</span><span class="p">)</span>
        <span class="n">proj_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">proj_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_cea_radio</span><span class="p">)</span>
        <span class="n">proj_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_top_radio</span><span class="p">)</span>
        <span class="n">proj_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_group</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">proj_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_cea_radio</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proj_top_radio</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>

        <span class="c1"># Standalone disambiguation group in model configuration (not part of workflow options).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_group</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Pi-disambiguation&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_hmi_radio</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;HMI&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_sfq_radio</span> <span class="o">=</span> <span class="n">QRadioButton</span><span class="p">(</span><span class="s2">&quot;SFQ&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_hmi_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_button_group</span> <span class="o">=</span> <span class="n">QButtonGroup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disambig_group</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_button_group</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disambig_hmi_radio</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_button_group</span><span class="o">.</span><span class="n">addButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disambig_sfq_radio</span><span class="p">)</span>
        <span class="n">disambig_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">disambig_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disambig_hmi_radio</span><span class="p">)</span>
        <span class="n">disambig_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disambig_sfq_radio</span><span class="p">)</span>
        <span class="n">disambig_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_group</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">disambig_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_hmi_radio</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disambig_sfq_radio</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>

        <span class="c1"># Keep projection and disambiguation on one row.</span>
        <span class="n">proj_disambig_row</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">proj_disambig_row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_group</span><span class="p">)</span>
        <span class="n">proj_disambig_row</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">disambig_group</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verticalLayout_2</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">proj_disambig_row</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_get_jump_action</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;rebuild_obs&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;rebuild_none&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;continue&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_set_jump_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="p">(</span><span class="n">action</span> <span class="ow">or</span> <span class="s2">&quot;continue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continue_radio</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continue_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;continue&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;rebuild_none&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;rebuild_obs&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">continue_radio</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_reset_pipeline_checks_for_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">boxes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_early_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_bounds_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_nas_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_gen_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty_box_only_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_bnd_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">potential_only_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlfff_only_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generic_only_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_vox_box</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boxes</span><span class="p">:</span>
            <span class="n">b</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">b</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">b</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="PyAmppGUI.add_options_section">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.add_options_section">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_options_section</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the options section to the main layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optionsGroupBox</span><span class="o">.</span><span class="n">setTitle</span><span class="p">(</span><span class="s2">&quot;Pipeline Workflow&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Download HMI Vector Magnetograms&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_early_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Stop&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_bounds_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Stop after POT&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Skip NLFFF stage&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Download AIA/UV&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Download AIA/EUV&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Save Empty Box (NONE)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Save Potential Box (POT)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_bounds_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Save Bounds Box (BND)&quot;</span><span class="p">)</span>

        <span class="c1"># Additional CLI parity controls (added programmatically to preserve .ui compatibility)</span>
        <span class="n">options_layout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optionsGroupBox</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">options_layout</span><span class="o">.</span><span class="n">count</span><span class="p">():</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">options_layout</span><span class="o">.</span><span class="n">takeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">widget</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_nas_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Save NLFFF Box (NAS)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_gen_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Save Lines (GEN)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">empty_box_only_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Stop after NONE&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_bnd_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Stop after BND&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential_only_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Potential Only&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nlfff_only_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Stop after NAS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generic_only_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Stop after GEN&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Skip Line Computation&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_vox_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Center Box Tracing&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Add and save Chromo Model (CHR)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Stage-ordered two-column workflow layout.</span>
        <span class="c1"># Two columns, 8 rows each, strict requested order (fill column 1 then column 2).</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>           <span class="c1"># 1</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>            <span class="c1"># 2</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>           <span class="c1"># 3</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_early_box</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>             <span class="c1"># 4</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>             <span class="c1"># 5</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">empty_box_only_box</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>         <span class="c1"># 6</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>         <span class="c1"># 7</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_bounds_box</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>            <span class="c1"># 8</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># 9</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># 10</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_nas_box</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>               <span class="c1"># 11</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlfff_only_box</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>             <span class="c1"># 12</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 13</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_gen_box</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>               <span class="c1"># 14</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generic_only_box</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>           <span class="c1"># 15</span>
        <span class="n">options_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>        <span class="c1"># 16</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_vox_box</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Line tracing mode: Fast is default; enable for center-voxel tracing.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_vox_box</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Keep only for CLI backward compatibility.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential_only_box</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Update command/state when options change</span>
        <span class="n">dynamic_widgets</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_early_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_bounds_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_nas_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save_gen_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">empty_box_only_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_bnd_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nlfff_only_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generic_only_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">dynamic_widgets</span><span class="p">:</span>
            <span class="n">w</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sync_pipeline_options</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_set_checkbox_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">enabled</span><span class="p">):</span>
        <span class="n">box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">enabled</span> <span class="ow">and</span> <span class="n">box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">box</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span>
        <span class="n">box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_sync_pipeline_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enforce linear stage workflow:</span>
<span class="sd">        - from scratch (no entry): full pipeline options</span>
<span class="sd">        - entry selected: forward-only from detected stage</span>
<span class="sd">        - rebuild selected: restart from NONE using restored parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">stage_rank</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;NONE&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;BND&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;NAS&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;GEN&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;CHR&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
            <span class="n">save_stage_boxes</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_bounds_box</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_nas_box</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_gen_box</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="p">]</span>
            <span class="n">stop_stage_boxes</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_early_box</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">empty_box_only_box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlfff_only_box</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_nas_box</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generic_only_box</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_gen_box</span><span class="p">),</span>
            <span class="p">]</span>

            <span class="n">has_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_entry_box</span><span class="p">()</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_jump_action</span><span class="p">()</span>
            <span class="n">rebuild_obs</span> <span class="o">=</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;rebuild_obs&quot;</span>
            <span class="n">rebuild_none</span> <span class="o">=</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;rebuild_none&quot;</span>
            <span class="n">start_stage</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">has_entry</span> <span class="ow">or</span> <span class="n">rebuild_obs</span> <span class="ow">or</span> <span class="n">rebuild_none</span><span class="p">)</span> <span class="k">else</span> <span class="n">stage_rank</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_entry_stage_detected</span> <span class="ow">or</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">has_entry</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;continue&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_jump_action</span><span class="p">(</span><span class="s2">&quot;continue&quot;</span><span class="p">)</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;continue&quot;</span>
                <span class="n">rebuild_obs</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">rebuild_none</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_none_radio</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_entry</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rebuild_obs_radio</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_entry</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_model_params_enabled</span><span class="p">((</span><span class="ow">not</span> <span class="n">has_entry</span><span class="p">)</span> <span class="ow">or</span> <span class="n">rebuild_obs</span><span class="p">)</span>

            <span class="c1"># Strict no-going-back for map downloads when resuming from entry box.</span>
            <span class="k">if</span> <span class="n">has_entry</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">rebuild_obs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="p">):</span>
                    <span class="n">box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">box</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">download_hmi_box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Keep stop controls mutually exclusive in stage order.</span>
            <span class="n">stop_stage</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">chosen_box</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">box</span><span class="p">,</span> <span class="n">stage</span><span class="p">,</span> <span class="n">_save</span> <span class="ow">in</span> <span class="n">stop_stage_boxes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                    <span class="n">stop_stage</span> <span class="o">=</span> <span class="n">stage</span>
                    <span class="n">chosen_box</span> <span class="o">=</span> <span class="n">box</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">stop_stage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">box</span><span class="p">,</span> <span class="n">_stage</span><span class="p">,</span> <span class="n">_save</span> <span class="ow">in</span> <span class="n">stop_stage_boxes</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">box</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">chosen_box</span> <span class="ow">and</span> <span class="n">box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                        <span class="n">box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

            <span class="n">use_potential</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
            <span class="n">skip_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
            <span class="c1"># Allow skip-NLFFF from NONE/POT/BND starts.</span>
            <span class="k">if</span> <span class="n">start_stage</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_checkbox_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
                <span class="n">use_potential</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Skip-NLFFF is only meaningful if pipeline can proceed beyond POT.</span>
                <span class="n">skip_enabled</span> <span class="o">=</span> <span class="n">stop_stage</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">stop_stage</span> <span class="o">&gt;=</span> <span class="mi">2</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_checkbox_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="p">,</span> <span class="n">skip_enabled</span><span class="p">)</span>
                <span class="n">use_potential</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

            <span class="n">skip_lines_enabled</span> <span class="o">=</span> <span class="n">start_stage</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stop_stage</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">stop_stage</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_checkbox_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span><span class="p">,</span> <span class="n">skip_lines_enabled</span><span class="p">)</span>
            <span class="n">skip_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">box</span><span class="p">,</span> <span class="n">stage</span><span class="p">,</span> <span class="n">_save</span> <span class="ow">in</span> <span class="n">stop_stage_boxes</span><span class="p">:</span>
                <span class="n">enabled</span> <span class="o">=</span> <span class="p">(</span><span class="n">stage</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">start_stage</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">stage</span> <span class="o">&gt;=</span> <span class="n">start_stage</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">stop_stage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">stage</span> <span class="o">&gt;</span> <span class="n">stop_stage</span><span class="p">:</span>
                    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">use_potential</span> <span class="ow">and</span> <span class="n">stage</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">skip_lines</span> <span class="ow">and</span> <span class="n">stage</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_checkbox_state</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">enabled</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">box</span><span class="p">,</span> <span class="n">stage</span> <span class="ow">in</span> <span class="n">save_stage_boxes</span><span class="p">:</span>
                <span class="n">enabled</span> <span class="o">=</span> <span class="n">stage</span> <span class="o">&gt;=</span> <span class="n">start_stage</span>
                <span class="k">if</span> <span class="n">stop_stage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">stage</span> <span class="o">&gt;</span> <span class="n">stop_stage</span><span class="p">:</span>
                    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">use_potential</span> <span class="ow">and</span> <span class="n">stage</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">skip_lines</span> <span class="ow">and</span> <span class="n">stage</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="c1"># Requested behavior: when stopping after POT, POT save is default</span>
                <span class="c1"># while Save BND stays available as an optional bonus.</span>
                <span class="k">if</span> <span class="n">stop_stage</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">stage</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">enabled</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_checkbox_state</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">enabled</span><span class="p">)</span>

            <span class="c1"># When a stop is selected, corresponding save is automatic.</span>
            <span class="k">if</span> <span class="n">stop_stage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_stop_box</span><span class="p">,</span> <span class="n">stage</span><span class="p">,</span> <span class="n">save_box</span> <span class="ow">in</span> <span class="n">stop_stage_boxes</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">stage</span> <span class="o">==</span> <span class="n">stop_stage</span> <span class="ow">and</span> <span class="n">save_box</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">save_box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">save_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                        <span class="n">save_box</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="n">save_box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                        <span class="k">break</span>

            <span class="c1"># CHR control is explicit and final-stage save is implicit.</span>
            <span class="n">chr_enabled</span> <span class="o">=</span> <span class="n">start_stage</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="ow">and</span> <span class="p">(</span><span class="n">stop_stage</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">stop_stage</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_checkbox_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="p">,</span> <span class="n">chr_enabled</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">chr_enabled</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="c1"># keep unchecked by user; handled as stop-after-gen.</span>
                <span class="k">pass</span>

            <span class="c1"># center-vox matters only when lines are computed.</span>
            <span class="n">center_vox_enabled</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">start_stage</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">center_vox_enabled</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">stop_stage</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">stop_stage</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">center_vox_enabled</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">skip_lines</span><span class="p">:</span>
                <span class="n">center_vox_enabled</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_checkbox_state</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center_vox_box</span><span class="p">,</span> <span class="n">center_vox_enabled</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUI workflow sync error: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="PyAmppGUI.add_cmd_display">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.add_cmd_display">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_cmd_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the command display section to the main layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mono</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Menlo&quot;</span><span class="p">)</span>
        <span class="n">mono</span><span class="o">.</span><span class="n">setStyleHint</span><span class="p">(</span><span class="n">QFont</span><span class="o">.</span><span class="n">Monospace</span><span class="p">)</span>
        <span class="n">mono</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmd_display_edit</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.add_cmd_buttons">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.add_cmd_buttons">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_cmd_buttons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the command buttons to the main layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_only_box</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="s2">&quot;Info Only&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_only_box</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">)</span>
        <span class="c1"># Place utility toggle with execution controls, not pipeline-flow options.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmd_button_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">spacer_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmd_button_layout</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cmd_button_layout</span><span class="o">.</span><span class="n">insertWidget</span><span class="p">(</span><span class="n">spacer_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_only_box</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">execute_command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">save_command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Send to gxbox-view&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Open latest generated model in gxbox-view&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmd_button_layout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">spacer_idx</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmd_button_layout</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cmd_button_layout</span><span class="o">.</span><span class="n">insertWidget</span><span class="p">(</span><span class="n">spacer_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">send_to_gxbox_view</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_button_refresh</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh_command</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_button_clear</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_button_clear</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear_button_clear</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clear_command</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.add_status_log">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.add_status_log">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_status_log</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds the status log section to the main layout.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mono</span> <span class="o">=</span> <span class="n">QFont</span><span class="p">(</span><span class="s2">&quot;Menlo&quot;</span><span class="p">)</span>
        <span class="n">mono</span><span class="o">.</span><span class="n">setStyleHint</span><span class="p">(</span><span class="n">QFont</span><span class="o">.</span><span class="n">Monospace</span><span class="p">)</span>
        <span class="n">mono</span><span class="o">.</span><span class="n">setPointSize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">setFont</span><span class="p">(</span><span class="n">mono</span><span class="p">)</span>
        <span class="c1"># Move console to a right-side dock panel to keep the main workflow visible.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">item</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">main_layout</span><span class="o">.</span><span class="n">takeAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span> <span class="o">=</span> <span class="n">QDockWidget</span><span class="p">(</span><span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;consoleDock&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="o">.</span><span class="n">setAllowedAreas</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="o">.</span><span class="n">setFeatures</span><span class="p">(</span><span class="n">QDockWidget</span><span class="o">.</span><span class="n">DockWidgetMovable</span> <span class="o">|</span> <span class="n">QDockWidget</span><span class="o">.</span><span class="n">DockWidgetFloatable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="o">.</span><span class="n">setMinimumWidth</span><span class="p">(</span><span class="mi">340</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">520</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="p">)</span>
        <span class="n">title_bar</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="p">)</span>
        <span class="n">title_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">title_bar</span><span class="p">)</span>
        <span class="n">title_layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">title_layout</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">title_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Console&quot;</span><span class="p">,</span> <span class="n">title_bar</span><span class="p">)</span>
        <span class="n">title_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">title_label</span><span class="p">)</span>
        <span class="n">title_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_menu_button</span> <span class="o">=</span> <span class="n">QToolButton</span><span class="p">(</span><span class="n">title_bar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_menu_button</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_menu_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Console options&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_menu_button</span><span class="o">.</span><span class="n">setPopupMode</span><span class="p">(</span><span class="n">QToolButton</span><span class="o">.</span><span class="n">InstantPopup</span><span class="p">)</span>
        <span class="n">console_menu</span> <span class="o">=</span> <span class="n">QMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">console_menu_button</span><span class="p">)</span>
        <span class="n">console_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;Clear&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear_console</span><span class="p">)</span>
        <span class="n">console_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;Copy All&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_console</span><span class="p">)</span>
        <span class="n">console_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;Save As...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_console</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_menu_button</span><span class="o">.</span><span class="n">setMenu</span><span class="p">(</span><span class="n">console_menu</span><span class="p">)</span>
        <span class="n">title_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">console_menu_button</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="o">.</span><span class="n">setTitleBarWidget</span><span class="p">(</span><span class="n">title_bar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addDockWidget</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">console_dock</span><span class="p">)</span></div>


    <span class="nd">@validate_number</span>
<div class="viewcode-block" id="PyAmppGUI.on_coord_x_input_return_pressed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_coord_x_input_return_pressed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_coord_x_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span></div>


    <span class="nd">@validate_number</span>
<div class="viewcode-block" id="PyAmppGUI.on_coord_y_input_return_pressed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_coord_y_input_return_pressed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_coord_y_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span></div>


    <span class="nd">@validate_number</span>
<div class="viewcode-block" id="PyAmppGUI.on_grid_x_input_return_pressed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_grid_x_input_return_pressed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_grid_x_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span></div>


    <span class="nd">@validate_number</span>
<div class="viewcode-block" id="PyAmppGUI.on_grid_y_input_return_pressed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_grid_y_input_return_pressed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_grid_y_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span></div>


    <span class="nd">@validate_number</span>
<div class="viewcode-block" id="PyAmppGUI.on_grid_z_input_return_pressed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_grid_z_input_return_pressed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_grid_z_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span></div>


    <span class="nd">@validate_number</span>
<div class="viewcode-block" id="PyAmppGUI.on_res_input_return_pressed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_res_input_return_pressed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_res_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.on_padding_size_input_return_pressed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_padding_size_input_return_pressed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_padding_size_input_return_pressed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_remove_stretch_from_layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes the last stretch item from the given layout if it exists.</span>

<span class="sd">        This method checks the last item in the layout and removes it if it is a spacer item.</span>
<span class="sd">        It is useful for dynamically managing layout items, especially when adding or removing widgets.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        layout : QLayout</span>
<span class="sd">            The layout from which the stretch item should be removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">layout</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layout</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">spacerItem</span><span class="p">():</span>
            <span class="n">layout</span><span class="o">.</span><span class="n">takeAt</span><span class="p">(</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

<div class="viewcode-block" id="PyAmppGUI.on_time_input_changed">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_time_input_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_time_input_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coords_center</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_time_orig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span><span class="o">.</span><span class="n">toPyDateTime</span><span class="p">())</span><span class="o">.</span><span class="n">mjd</span>
            <span class="n">model_time_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_time_orig</span><span class="o">.</span><span class="n">mjd</span>
            <span class="n">time_sec_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="n">model_time_orig</span><span class="p">)</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">time_sec_diff</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">time_sec_diff</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">on_rotate_model_to_time</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_remove_stretch_from_layout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_layout</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Revert&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Revert the model to the original time&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_rotate_revert_button_clicked</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_time_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_time_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_coords_center</span><span class="p">(</span><span class="n">revert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_remove_stretch_from_layout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_layout</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_time_layout</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert_button</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">model_time_layout</span><span class="o">.</span><span class="n">addStretch</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.on_rotate_revert_button_clicked">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_rotate_revert_button_clicked">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_rotate_revert_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">setDateTime</span><span class="p">(</span><span class="n">QDateTime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_orig</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotate_revert</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.rotate_revert">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.rotate_revert">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rotate_revert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_hpc_state</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_hgc_state</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_hgs_state</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.on_rotate_model_to_time">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.on_rotate_model_to_time">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_rotate_model_to_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotates the model to the specified time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sunpy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">RotatedSunFrame</span>
        <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center_orig</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span><span class="o">.</span><span class="n">toPyDateTime</span><span class="p">())</span><span class="o">.</span><span class="n">mjd</span>
        <span class="n">model_time_orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_time_orig</span><span class="o">.</span><span class="n">mjd</span>
        <span class="n">time_sec_diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span> <span class="o">-</span> <span class="n">model_time_orig</span><span class="p">)</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">3600</span>
        <span class="n">diffrot_point</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">RotatedSunFrame</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">time_sec_diff</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span> <span class="o">=</span> <span class="n">diffrot_point</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_coords_center</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords_center_orig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="p">)</span>
        <span class="c1"># self.status_log_edit.append(&quot;Model rotated to the specified time&quot;)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_hpc_state</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_hgc_state</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_hgs_state</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.update_command_display">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_command_display">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_command_display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the command display with the current command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_hydrating_entry&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coords_center</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_command</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cmd_display_edit</span><span class="o">.</span><span class="n">setPlainText</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUI update error: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.update_hpc_state">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_hpc_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_hpc_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">,</span> <span class="n">coords_center</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the UI when Helioprojective coordinates are selected.</span>

<span class="sd">        :param checked: Whether the Helioprojective radio button is checked.</span>
<span class="sd">        :type checked: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">checked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Solar X coordinate of the model center in arcsec&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Solar Y coordinate of the model center in arcsec&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Center Coords  in arcsec&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;X:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Y:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">coords_center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">obstime</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span><span class="o">.</span><span class="n">toPyDateTime</span><span class="p">())</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="n">get_earth</span><span class="p">(</span><span class="n">obstime</span><span class="p">)</span>
                <span class="n">coords_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span><span class="n">Helioprojective</span><span class="p">(</span><span class="n">obstime</span><span class="o">=</span><span class="n">obstime</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">observer</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">coords_center</span><span class="o">.</span><span class="n">Tx</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">coords_center</span><span class="o">.</span><span class="n">Ty</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.update_hgc_state">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_hgc_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_hgc_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">,</span> <span class="n">coords_center</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the UI when Heliographic Carrington coordinates are selected.</span>

<span class="sd">        :param checked: Whether the Heliographic Carrington radio button is checked.</span>
<span class="sd">        :type checked: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">checked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Heliographic Carrington Longitude of the model center in deg&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Heliographic Carrington Latitude of the model center in deg&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Center Coords in deg&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;lon:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;lat:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">coords_center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;coords_center: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">obstime</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span><span class="o">.</span><span class="n">toPyDateTime</span><span class="p">())</span>
                <span class="n">observer</span> <span class="o">=</span> <span class="n">get_earth</span><span class="p">(</span><span class="n">obstime</span><span class="p">)</span>
                <span class="n">coords_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span>
                    <span class="n">HeliographicCarrington</span><span class="p">(</span><span class="n">obstime</span><span class="o">=</span><span class="n">obstime</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">observer</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;new coords_center: </span><span class="si">{</span><span class="n">coords_center</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">coords_center</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">coords_center</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.update_hgs_state">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_hgs_state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_hgs_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checked</span><span class="p">,</span> <span class="n">coords_center</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the UI when Heliographic Stonyhurst coordinates are selected.</span>

<span class="sd">        :param checked: Whether the Heliographic Stonyhurst radio button is checked.</span>
<span class="sd">        :type checked: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">checked</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Heliographic Stonyhurst Longitude of the model center in deg&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Heliographic Stonyhurst Latitude of the model center in deg&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Center Coords in deg&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;lon:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;lat:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">coords_center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">obstime</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span><span class="o">.</span><span class="n">toPyDateTime</span><span class="p">())</span>
                <span class="c1"># observer = get_earth(obstime)</span>
                <span class="n">coords_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span><span class="o">.</span><span class="n">transform_to</span><span class="p">(</span>
                    <span class="n">HeliographicStonyhurst</span><span class="p">(</span><span class="n">obstime</span><span class="o">=</span><span class="n">obstime</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">coords_center</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">coords_center</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.update_coords_center">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.update_coords_center">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_coords_center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">revert</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">revert</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords_center_orig</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords_center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coords_center</span></div>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_coords_center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">time</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span><span class="o">.</span><span class="n">toPyDateTime</span><span class="p">())</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()),</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())]</span>
        <span class="n">observer</span> <span class="o">=</span> <span class="n">get_earth</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">coords_center</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span> <span class="n">obstime</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">observer</span><span class="p">,</span>
                                     <span class="n">rsun</span><span class="o">=</span><span class="mi">696</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mm</span><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;helioprojective&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">coords_center</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">obstime</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">observer</span><span class="p">,</span>
                                     <span class="n">radius</span><span class="o">=</span><span class="mi">696</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mm</span><span class="p">,</span>
                                     <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;heliographic_carrington&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgs_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">coords_center</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">obstime</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">observer</span><span class="p">,</span>
                                     <span class="n">radius</span><span class="o">=</span><span class="mi">696</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mm</span><span class="p">,</span>
                                     <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;heliographic_stonyhurst&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coords_center</span>

<div class="viewcode-block" id="PyAmppGUI.get_command">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.get_command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs the command based on the current UI settings.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            The command as a list of strings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">astropy.time</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>

        <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gx-fov2box&#39;</span><span class="p">]</span>
        <span class="n">has_entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_entry_box</span><span class="p">()</span>
        <span class="n">jump_action</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_jump_action</span><span class="p">()</span>

        <span class="c1"># In entry continue/rebuild-none modes keep CLI minimal: entry-box + restored/selected paths + workflow flags.</span>
        <span class="k">if</span> <span class="n">has_entry</span> <span class="ow">and</span> <span class="n">jump_action</span> <span class="o">!=</span> <span class="s2">&quot;rebuild_obs&quot;</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--data-dir&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--gxmodel-dir&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--entry-box&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">astropy</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">Time</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">dateTime</span><span class="p">()</span><span class="o">.</span><span class="n">toPyDateTime</span><span class="p">())</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--time&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">)]</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--coords&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hpc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--hpc&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hgc_radio_button</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--hgc&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--hgs&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_top_radio</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
                <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--top&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--cea&#39;</span><span class="p">]</span>

            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--box-dims&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_x_edit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_y_edit</span><span class="o">.</span><span class="n">text</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_z_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--dx-km&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">res_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--pad-frac&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">padding_size_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--data-dir&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sdo_data_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--gxmodel-dir&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>
            <span class="k">if</span> <span class="n">has_entry</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--entry-box&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">external_box_edit</span><span class="o">.</span><span class="n">text</span><span class="p">()]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_euv</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--euv&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">download_aia_uv</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--uv&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_empty_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--save-empty-box&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_potential_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--save-potential&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_bounds_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--save-bounds&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_nas_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--save-nas&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_gen_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--save-gen&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_early_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--stop-after&#39;</span><span class="p">,</span> <span class="s1">&#39;dl&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">empty_box_only_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--stop-after&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">stop_after_potential_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--stop-after&#39;</span><span class="p">,</span> <span class="s1">&#39;pot&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlfff_only_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--stop-after&#39;</span><span class="p">,</span> <span class="s1">&#39;nas&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">generic_only_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_save_chromo_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--stop-after&#39;</span><span class="p">,</span> <span class="s1">&#39;gen&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_nlfff_extrapolation</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--use-potential&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_line_computation_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--skip-lines&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_vox_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--center-vox&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">jump_action</span> <span class="o">==</span> <span class="s1">&#39;rebuild_obs&#39;</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--rebuild&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">jump_action</span> <span class="o">==</span> <span class="s1">&#39;rebuild_none&#39;</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--rebuild-from-none&#39;</span><span class="p">]</span>

        <span class="c1"># Disambiguation affects rebuild/new-box computation only.</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">has_entry</span> <span class="ow">or</span> <span class="n">jump_action</span> <span class="o">==</span> <span class="s2">&quot;rebuild_obs&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">disambig_sfq_radio</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--sfq&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_only_box</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">info_only_box</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;--info&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">command</span></div>


<div class="viewcode-block" id="PyAmppGUI.execute_command">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.execute_command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">execute_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes the constructed command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;GXbox Running&quot;</span><span class="p">,</span> <span class="s2">&quot;A GXbox process is already running.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_command</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_model_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="n">command</span><span class="p">,</span>
                <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span>
                <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">bufsize</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">,</span> <span class="s2">&quot;PYTHONUNBUFFERED&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">},</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">stdout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">set_blocking</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Command started: &quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_proc_timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Execution Error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to start command: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Command failed to start&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_drain_process_output</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">stdout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">stdout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">stdout</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="n">stdout</span><span class="o">.</span><span class="n">fileno</span><span class="p">()</span>
        <span class="n">chunks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">ready</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="n">fd</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ready</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">chunk</span> <span class="o">=</span> <span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">chunks</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">):</span>
            <span class="n">complete_lines</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">complete_lines</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">complete_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<div class="viewcode-block" id="PyAmppGUI.stop_command">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.stop_command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stop_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the running GXbox process if any.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;No running command to stop&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Stopping command...&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_drain_process_output</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Command stopped&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_drain_process_output</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Command killed&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">execute_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_proc_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_check_gxbox_process</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_proc_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_drain_process_output</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_drain_process_output</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_proc_partial_line</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">exit_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">returncode</span>
            <span class="k">if</span> <span class="n">exit_code</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Command finished successfully&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_last_model_path</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Command exited with code </span><span class="si">{</span><span class="n">exit_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GUI process-monitor error: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_gxbox_proc</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stop_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">execute_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_proc_timer</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<div class="viewcode-block" id="PyAmppGUI.save_command">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.save_command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the current command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Placeholder for saving command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Command saved&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.refresh_command">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.refresh_command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">refresh_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Refreshes the current session.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Placeholder for refreshing command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Command refreshed&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.clear_command">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.clear_command">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear_command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clears the status log.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Placeholder for clearing command</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>


<div class="viewcode-block" id="PyAmppGUI.clear_console">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.clear_console">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear_console</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clears the console panel.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_model_path</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="PyAmppGUI.copy_console">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.copy_console">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy_console</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copies the full console text to clipboard.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">clipboard</span><span class="p">()</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span></div>


<div class="viewcode-block" id="PyAmppGUI.save_console">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.save_console">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">save_console</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the console output to a text file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Save Console Output&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;pyampp_console.txt&quot;</span><span class="p">),</span>
            <span class="s2">&quot;Text Files (*.txt);;Log Files (*.log);;All Files (*)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Save Failed&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Could not save console output:</span><span class="se">\n</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_update_last_model_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">toPlainText</span><span class="p">()</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^- (.+\.h5)\s*$&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">flags</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">raw</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">candidates</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_last_model_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gx_model_edit</span><span class="o">.</span><span class="n">text</span><span class="p">())</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">newest</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">newest_mtime</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.h5&quot;</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mtime</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stat</span><span class="p">()</span><span class="o">.</span><span class="n">st_mtime</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">mtime</span> <span class="o">&gt;</span> <span class="n">newest_mtime</span><span class="p">:</span>
                <span class="n">newest_mtime</span> <span class="o">=</span> <span class="n">mtime</span>
                <span class="n">newest</span> <span class="o">=</span> <span class="n">p</span>
        <span class="k">if</span> <span class="n">newest</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_last_model_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">newest</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send_to_viewer_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<div class="viewcode-block" id="PyAmppGUI.send_to_gxbox_view">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.PyAmppGUI.send_to_gxbox_view">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">send_to_gxbox_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_model_path</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;No Model&quot;</span><span class="p">,</span> <span class="s2">&quot;No generated model was found to send.&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">model_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_last_model_path</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">model_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Missing Model&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Model file not found:</span><span class="se">\n</span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">start_dir</span> <span class="o">=</span> <span class="n">model_path</span><span class="o">.</span><span class="n">parent</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span>
                <span class="s2">&quot;gxbox-view&quot;</span><span class="p">,</span>
                <span class="s2">&quot;--pick&quot;</span><span class="p">,</span>
                <span class="s2">&quot;--dir&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">start_dir</span><span class="p">),</span>
                <span class="s2">&quot;--h5&quot;</span><span class="p">,</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">model_path</span><span class="p">),</span>
            <span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_log_edit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Launched gxbox-view with: </span><span class="si">{</span><span class="n">model_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Launch Failed&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Could not launch gxbox-view:</span><span class="se">\n</span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>



<span class="nd">@app</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<div class="viewcode-block" id="main">
<a class="viewcode-back" href="../../../autoapi/pyampp/gxbox/gxampp/index.html#pyampp.gxbox.gxampp.main">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
        <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">typer</span><span class="o">.</span><span class="n">Option</span><span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;--debug&quot;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Enable debug mode with an interactive IPython session.&quot;</span>
        <span class="p">)</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Entry point for the PyAmppGUI application.</span>

<span class="sd">    This function initializes the PyQt application, sets up and displays the main</span>
<span class="sd">    GUI window for the Solar Data Model. It pre-configures some GUI elements with default</span>
<span class="sd">    values for model time and coordinates. Default values are set programmatically</span>
<span class="sd">    before the event loop starts.</span>

<span class="sd">    :param debug: Enable debug mode with an interactive IPython session, defaults to False</span>
<span class="sd">    :type debug: bool, optional</span>
<span class="sd">    :raises SystemExit: Exits the application loop when the GUI is closed</span>
<span class="sd">    :return: None</span>
<span class="sd">    :rtype: NoneType</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    .. code-block:: bash</span>

<span class="sd">        gxampp</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">app_qt</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">([])</span>
    <span class="n">pyampp</span> <span class="o">=</span> <span class="n">PyAmppGUI</span><span class="p">()</span>
    <span class="n">pyampp</span><span class="o">.</span><span class="n">model_time_edit</span><span class="o">.</span><span class="n">setDateTime</span><span class="p">(</span><span class="n">QDateTime</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">pyampp</span><span class="o">.</span><span class="n">coord_x_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
    <span class="n">pyampp</span><span class="o">.</span><span class="n">coord_y_edit</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
    <span class="n">pyampp</span><span class="o">.</span><span class="n">update_coords_center</span><span class="p">()</span>
    <span class="n">pyampp</span><span class="o">.</span><span class="n">update_command_display</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="c1"># Start an interactive IPython session for debugging</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">IPython</span>
        <span class="n">IPython</span><span class="o">.</span><span class="n">embed</span><span class="p">()</span>

        <span class="c1"># If any matplotlib plots are created, show them</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app_qt</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, suncast-org.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>